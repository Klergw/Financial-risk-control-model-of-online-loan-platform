# [“魔镜杯”风控算法大赛](https://www.kesci.com/apps/home/#!/competition/56cd5f02b89b5bd026cb39c9/content/0)

> 拍拍贷“魔镜风控系统”从平均400个数据维度评估用户当前的信用状态，给每个借款人打出当前状态的信用分，在此基础上，再结合新发标的信息，打出对于每个标的6个月内逾期率的预测，为投资人提供了关键的决策依据，促进健康高效的互联网金融。拍拍贷首次开放丰富而真实的历史数据，邀你PK“魔镜风控系统”，通过机器学习技术，你能设计出更具预测准确率和计算性能的违约预测算法吗？

# 问题分析

​	本次实验数据集包括三万条标签已知的训练集和三万条标签未知的训练集，训练集和数据集均包括三个 csv 文件：Master（主要特征表）、Log_Info（用户登录信息表）和 Userupdate_Info（客户修改更新表）。我们可通过对四百多个维度的数据处理缺失值、空格和字符大小写等进行清洗；将 Feature 进行分类，把特征中的数值特征与类别特征分开，分别处理，并且剔除异常点；利用 xgboost 输出特征重要性进行筛选；选用 lightgbm 和 xgboost 模型进行建模和参数调优，预测测试集用户是否违约；最后权衡 xgboot 和 lightgbm 的结果，选择 auc 值最高的模型。

## 数据清洗与预处理

- 删去数据缺失接近百分之百的字段
- 其余缺失值很少的就用 0 来填充
- 剔除标准差几乎为零的特征项提高精度

## 特征分类

- 在所有的分类中，如果其中最大频率的值出现超过一定阈值（50%）, 则 把 这 列 转 化 为 二 值
- 剩余的feature中，根据类型把所有features分为numerical和categorical 2类
- 查看正负样本中特征取值的分布，我们可以剔除一些离群点，使模型训练更加精准

## 特征筛选

- 将 UserInfo_8 中城市名归一化，清理后非重复计数会减少
- 处理地点数据，首先从省份数据出发，推测一个可能是籍贯省份，一个可能是居住省份。筛选出户籍省份和居住地省份中违约率高的地点，将其二值化，然后删除原始特征。
- 从城市数据出发，原数据中有四个城市特征,推测为用户常登陆的 IP 地址城市，我们利用 xgboost 挑选重要的城市,并二值化进行特征衍生，将四个城市变量都进行哑变量处理。

##  训练评估

### XGBOOST

J将数据划分为训练集和测试集，直接进行 xgboost 建模

```
xgb = XGBClassifier(
learning_rate=0.05,
n_estimators=65, # 树的个数
max_depth=25, # 树深度
min_child_weight=8,
gamma=0, # 惩罚项系数
subsample=0.5,
colsample_bytree=0.8,
objective='binary:logistic',
nthread=4,
scale_pos_weight=23,
seed=27
)
```

### AUC评估：75.04
